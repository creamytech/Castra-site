import { NextResponse } from "next/server"; import { promises as fs } from "fs"; export async function POST(req: Request) { try { const { name = "", email = "", brokerage = "" } = await req.json(); if (!name || !email || !/^\S+@\S+\.\S+$/.test(email)) { return NextResponse.json({ ok: false, error: "Please provide a valid name and email." }, { status: 400 }); } const record = { name, email, brokerage, at: new Date().toISOString() }; const path = "/tmp/waitlist.json"; try { const existing = JSON.parse(await fs.readFile(path, "utf8")); existing.push(record); await fs.writeFile(path, JSON.stringify(existing, null, 2)); } catch { await fs.writeFile(path, JSON.stringify([record], null, 2)); } return NextResponse.json({ ok: true }); } catch (e: any) { return NextResponse.json({ ok: false, error: e?.message || "Server error." }, { status: 500 }); } }
