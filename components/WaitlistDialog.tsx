"use client"; import { useState } from "react"; import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog"; import { Button } from "@/components/ui/button"; import { Input } from "@/components/ui/input"; import { Label } from "@/components/ui/label"; export default function WaitlistDialog({ triggerClassName = "" }: { triggerClassName?: string }) { const [open, setOpen] = useState(false); const [loading, setLoading] = useState(false); const [msg, setMsg] = useState(""); async function onSubmit(e: React.FormEvent<HTMLFormElement>) { e.preventDefault(); setLoading(true); setMsg(""); const form = new FormData(e.currentTarget); const payload = Object.fromEntries(form.entries()); const res = await fetch("/api/waitlist", { method:"POST", headers:{ "Content-Type":"application/json" }, body: JSON.stringify(payload) }); const j = await res.json(); setLoading(false); if (j?.ok) { setMsg("Youre on the waitlist! Well be in touch soon."); (e.currentTarget as HTMLFormElement).reset(); } else { setMsg(j?.error || "Something went wrong. Please try again."); } } return ( <Dialog open={open} onOpenChange={setOpen}> <DialogTrigger asChild><Button className={triggerClassName}>Join Waitlist</Button></DialogTrigger> <DialogContent> <DialogHeader><DialogTitle className="font-serif text-xl">Join the Castra waitlist</DialogTitle></DialogHeader> <form className="grid gap-3" onSubmit={onSubmit}> <div className="grid gap-1"> <Label htmlFor="name">Name</Label> <Input id="name" name="name" required /> </div> <div className="grid gap-1"> <Label htmlFor="email">Email</Label> <Input id="email" name="email" type="email" required /> </div> <div className="grid gap-1"> <Label htmlFor="brokerage">Brokerage (optional)</Label> <Input id="brokerage" name="brokerage" /> </div> <Button disabled={loading} type="submit">{loading ? "Submitting" : "Submit"}</Button> {msg ? <div className="text-sm">{msg}</div> : null} </form> </DialogContent> </Dialog> ); }
